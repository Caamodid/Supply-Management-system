(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{4712:(e,a,t)=>{Promise.resolve().then(t.bind(t,5180))},5180:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m});var l=t(5155),n=t(2115),s=t(8017),d=t(6113),r=t(8747),c=t(4259),o=t(1215);function u(e){let{defaultValues:a,onChange:t}=e,[s,d]=(0,n.useState)([]),[r,c]=(0,n.useState)({companyId:(null==a?void 0:a.companyId)||"",branchName:(null==a?void 0:a.branchName)||"",address:(null==a?void 0:a.address)||"",phone:(null==a?void 0:a.phone)||""});(0,n.useEffect)(()=>{u()},[]);let u=async()=>{var e;let a=await o.B.getAll();(null===(e=a.data)||void 0===e?void 0:e.success)&&d(a.data.data)},i=(e,a)=>{let l={...r,[e]:a};c(l),null==t||t(l)};return(0,l.jsx)("form",{className:"space-y-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Company"}),(0,l.jsxs)("select",{value:r.companyId,onChange:e=>i("companyId",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",children:[(0,l.jsx)("option",{value:"",children:"Select company"}),s.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Branch Name"}),(0,l.jsx)("input",{value:r.branchName,onChange:e=>i("branchName",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter branch name"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),(0,l.jsx)("input",{value:r.phone,onChange:e=>i("phone",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter phone"})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Address"}),(0,l.jsx)("input",{value:r.address,onChange:e=>i("address",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter address"})]})]})})}var i=t(872),p=t(5686);function m(){let[e,a]=(0,n.useState)([]),[t,m]=(0,n.useState)(!0),[h,g]=(0,n.useState)(!1),[b,x]=(0,n.useState)(null),[y,f]=(0,n.useState)(null),[v,N]=(0,n.useState)(null),[B,j]=(0,n.useState)(null),[A,S]=(0,n.useState)(null),[C,k]=(0,n.useState)({page:1,perPage:5,total:0});(0,n.useEffect)(()=>{w()},[]);let w=async()=>{try{m(!0);let e=await o.B.getAllBranches();e.data.success&&(a(e.data.data),k(a=>({...a,total:e.data.data.length})))}catch(e){j("Failed to load branches"),S("error")}finally{m(!1)}},E=async()=>{if(y)try{let e;let a=new FormData;a.append("companyId",y.companyId),a.append("branchName",y.branchName),a.append("address",y.address),a.append("phone",y.phone),(e=b?await o.B.updateBranch(b.id,a):await o.B.createBranch(a)).data.success?(j(e.data.message),S("success"),w(),g(!1),x(null),f(null)):(j(e.data.message),S("error"))}catch(e){j("Operation failed"),S("error")}},U=async()=>{if(!v)return;let e=await o.B.deleteBranch(v);e.data.success&&(j(e.data.message),S("success"),w()),N(null)};(0,n.useEffect)(()=>{if(!B)return;let e=setTimeout(()=>{j(null),S(null)},3e3);return()=>clearTimeout(e)},[B]);let I=e.slice((C.page-1)*C.perPage,C.page*C.perPage);return(0,l.jsxs)("div",{className:"w-full space-y-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Branches"}),B&&(0,l.jsx)("div",{className:"px-4 py-3 rounded-md text-sm ".concat("success"===A?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:B}),(0,l.jsx)(s.A,{columns:[{key:"branchName",label:"Branch Name"},{key:"compnayName",label:"Company"},{key:"phone",label:"Phone"},{key:"address",label:"Address"}],data:I,loading:t,rightAction:(0,l.jsx)("button",{onClick:()=>{x(null),f(null),g(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"+ Add Branch"}),renderActions:e=>(0,l.jsx)(d.A,{actions:[{label:"Edit",icon:(0,l.jsx)(i.A,{size:16}),onClick:()=>{x(e),f(null),g(!0)}},{label:"Delete",icon:(0,l.jsx)(p.A,{size:16}),danger:!0,onClick:()=>N(e.id),attributes:{"data-bs-toggle":"modal","data-bs-target":"#deleteBranchModal"}}]}),pagination:C,onPageChange:e=>k({...C,page:e})}),(0,l.jsx)(r.A,{open:h,title:b?"Edit Branch":"Add Branch",confirmText:b?"Update Branch":"Save Branch",onClose:()=>{g(!1),x(null),f(null)},onConfirm:E,children:(0,l.jsx)(u,{defaultValues:b?{branchName:b.branchName,address:b.address,phone:b.phone}:void 0,onChange:f})}),(0,l.jsx)(c.A,{id:"deleteBranchModal",title:"Delete Branch",message:"Are you sure you want to delete this branch?",confirmText:"Delete",onConfirm:U})]})}},1215:(e,a,t)=>{"use strict";t.d(a,{B:()=>n});var l=t(2649);let n={getAll:()=>l.A.get("/SetUp/companies"),getById:e=>l.A.get("/SetUp/get-company/".concat(e)),create:e=>l.A.post("/SetUp/create-company",e,{headers:{"Content-Type":"multipart/form-data"}}),updateCompany:(e,a)=>l.A.put("/SetUp/edit-company/".concat(e),a,{headers:{"Content-Type":"multipart/form-data"}}),delete:e=>l.A.delete("/SetUp/delete-company/".concat(e)),getAllBranches:()=>l.A.get("/SetUp/branches"),getByIdBranch:e=>l.A.get("/SetUp/get-branch/".concat(e)),createBranch:e=>l.A.post("/SetUp/create-branch",e,{headers:{"Content-Type":"multipart/form-data"}}),updateBranch:(e,a)=>l.A.put("/SetUp/edit-branch/".concat(e),a,{headers:{"Content-Type":"multipart/form-data"}}),deleteBranch:e=>l.A.delete("/SetUp/delete-branch/".concat(e))}}},e=>{var a=a=>e(e.s=a);e.O(0,[651,880,441,517,358],()=>a(4712)),_N_E=e.O()}]);