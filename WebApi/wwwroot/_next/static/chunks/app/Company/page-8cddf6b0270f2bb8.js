(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[338],{6362:(e,a,l)=>{Promise.resolve().then(l.bind(l,2699))},2699:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>p});var t=l(5155),s=l(2115),n=l(8017),o=l(6113),d=l(8747),r=l(4259);function c(e){let{defaultValues:a,onChange:l}=e,[n,o]=(0,s.useState)({name:(null==a?void 0:a.name)||"",address:(null==a?void 0:a.address)||"",phone:(null==a?void 0:a.phone)||"",email:(null==a?void 0:a.email)||"",logo:null}),[d,r]=(0,s.useState)((null==a?void 0:a.logoUrl)||null),c=(e,a)=>{let t={...n,[e]:a};o(t),null==l||l(t)},i=e=>{e&&(c("logo",e),r(URL.createObjectURL(e)))};return(0,t.jsx)("form",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Company Name"}),(0,t.jsx)("input",{value:n.name,onChange:e=>c("name",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter company name"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),(0,t.jsx)("input",{value:n.phone,onChange:e=>c("phone",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter phone number"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Email"}),(0,t.jsx)("input",{type:"email",value:n.email,onChange:e=>c("email",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter email address"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Address"}),(0,t.jsx)("input",{value:n.address,onChange:e=>c("address",e.target.value),className:"w-full rounded-lg border px-3 py-2 text-sm",placeholder:"Enter company address"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Company Logo"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[d&&(0,t.jsx)("img",{src:d,alt:"Logo Preview",className:"h-16 w-16 rounded border object-contain"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;return i((null===(a=e.target.files)||void 0===a?void 0:a[0])||null)},className:"block text-sm"})]})]})]})})}var i=l(1215),m=l(872),u=l(5686);function p(){let[e,a]=(0,s.useState)([]),[l,p]=(0,s.useState)(!0),[g,h]=(0,s.useState)(!1),[x,y]=(0,s.useState)(null),[b,v]=(0,s.useState)(null),[f,j]=(0,s.useState)(null),[C,A]=(0,s.useState)(null),[N,S]=(0,s.useState)(null),[U,k]=(0,s.useState)({page:1,perPage:5,total:0});(0,s.useEffect)(()=>{w()},[]);let w=async()=>{try{p(!0);let e=(await i.B.getAll()).data;e.success&&(a(e.data),k(a=>({...a,total:e.data.length})))}catch(a){var e,l;A((null===(l=a.response)||void 0===l?void 0:null===(e=l.data)||void 0===e?void 0:e.message)||"Failed to load companies"),S("error")}finally{p(!1)}},B=[{key:"name",label:"Company Name"},{key:"createdAt",label:"Created At"},{key:"phone",label:"Phone"},{key:"address",label:"Address"},{key:"logoUrl",label:"Logo",render:e=>e.logoUrl?(0,t.jsx)("img",{src:e.logoUrl,alt:"logo",className:"h-8 w-8 rounded object-contain"}):(0,t.jsx)("span",{className:"text-gray-400 text-xs",children:"No Logo"})}],E=async()=>{if(b)try{let e=new FormData;e.append("name",b.name),e.append("address",b.address),e.append("phone",b.phone),e.append("email",b.email),b.logo&&e.append("logo",b.logo);let a=(x?await i.B.updateCompany(x.id,e):await i.B.create(e)).data;a.success?(A(a.message),S("success"),w(),h(!1),y(null),v(null)):(A(a.message),S("error"))}catch(l){var e,a;A((null===(a=l.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Operation failed"),S("error")}},P=async()=>{if(f){try{let e=(await i.B.delete(f)).data;e.success?(A(e.message),S("success"),w()):(A(e.message),S("error"))}catch(l){var e,a;A((null===(a=l.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"Delete failed"),S("error")}j(null)}};(0,s.useEffect)(()=>{if(!C)return;let e=setTimeout(()=>{A(null),S(null)},3e3);return()=>clearTimeout(e)},[C]);let T=e.slice((U.page-1)*U.perPage,U.page*U.perPage);return(0,t.jsxs)("div",{className:"w-full space-y-4",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Companies"})}),C&&(0,t.jsx)("div",{className:"px-4 py-3 rounded-md text-sm ".concat("success"===N?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:C}),(0,t.jsx)(n.A,{columns:B,data:T,loading:l,rightAction:(0,t.jsx)("button",{onClick:()=>{y(null),v(null),h(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"+ Add Company"}),renderActions:e=>(0,t.jsx)(o.A,{actions:[{label:"Edit",icon:(0,t.jsx)(m.A,{size:16}),onClick:()=>{y(e),v(null),h(!0)}},{label:"Delete",icon:(0,t.jsx)(u.A,{size:16}),danger:!0,onClick:()=>j(e.id),attributes:{"data-bs-toggle":"modal","data-bs-target":"#deleteCompanyModal"}}]}),pagination:U,onPageChange:e=>{k(a=>({...a,page:e}))}}),(0,t.jsx)(d.A,{open:g,title:x?"Edit Company":"Add Company",confirmText:x?"Update Company":"Save Company",onClose:()=>{h(!1),y(null),v(null)},onConfirm:E,children:(0,t.jsx)(c,{defaultValues:x?{name:x.name,address:x.address,phone:x.phone,email:x.email,logoUrl:x.logoUrl}:void 0,onChange:v})}),(0,t.jsx)(r.A,{id:"deleteCompanyModal",title:"Delete Company",message:"Are you sure you want to delete this company?",confirmText:"Delete",onConfirm:P})]})}},1215:(e,a,l)=>{"use strict";l.d(a,{B:()=>s});var t=l(2649);let s={getAll:()=>t.A.get("/SetUp/companies"),getById:e=>t.A.get("/SetUp/get-company/".concat(e)),create:e=>t.A.post("/SetUp/create-company",e,{headers:{"Content-Type":"multipart/form-data"}}),updateCompany:(e,a)=>t.A.put("/SetUp/edit-company/".concat(e),a,{headers:{"Content-Type":"multipart/form-data"}}),delete:e=>t.A.delete("/SetUp/delete-company/".concat(e)),getAllBranches:()=>t.A.get("/SetUp/branches"),getByIdBranch:e=>t.A.get("/SetUp/get-branch/".concat(e)),createBranch:e=>t.A.post("/SetUp/create-branch",e,{headers:{"Content-Type":"multipart/form-data"}}),updateBranch:(e,a)=>t.A.put("/SetUp/edit-branch/".concat(e),a,{headers:{"Content-Type":"multipart/form-data"}}),deleteBranch:e=>t.A.delete("/SetUp/delete-branch/".concat(e))}}},e=>{var a=a=>e(e.s=a);e.O(0,[651,880,441,517,358],()=>a(6362)),_N_E=e.O()}]);